C51 COMPILER V9.54   SPI                                                                   02/10/2025 15:30:51 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SPI
OBJECT MODULE PLACED IN .\Objects\spi.obj
COMPILER INVOKED BY: D:\Keil_5\C51\BIN\C51.EXE spi.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\spi.ls
                    -t) TABS(2) OBJECT(.\Objects\spi.obj)

line level    source

   1          #include <STC8H.H>
   2          #include "spi.h"
   3          
   4          void spi_init()
   5          {
   6   1          CS = 1;
   7   1          SCL = 1;
   8   1          MOSI = 0;
   9   1          MISO = 0;
  10   1      }
  11          
  12          void spi_start()
  13          {
  14   1          CS = 0;
  15   1      }
  16          
  17          void spi_stop()
  18          {
  19   1          CS = 1;
  20   1      }
  21          
  22          unsigned char spi_exchangebyte(unsigned char byte)
  23          {
  24   1          char i;
  25   1          char temp = 0;
  26   1          spi_start();
  27   1          for (i = 0; i < 8; i++)
  28   1          {
  29   2              SCL = 0;
  30   2              MOSI = byte & (0x80 >> i);
  31   2              if (MISO)
  32   2                  temp |= (0x80 >> i);
  33   2              SCL = 1;
  34   2          }
  35   1          spi_stop();
  36   1          return temp;
  37   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     82    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
